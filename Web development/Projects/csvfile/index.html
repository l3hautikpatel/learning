<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Text Extraction</title>
  <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.312/build/pdf.js"></script> -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf_viewer.min.css" integrity="sha512-v7RQDI7qsfFNaXRzzylpsVV7ncQBdyozLze5YNgox/0z4Mc3Ellt2dBd0CbmufeD7IIh5TCJQ8ORAF/KvzVITg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/+esm"></script>
  
</head>
<body>

<!-- HTML form for PDF file input -->
<form id="pdfForm">
  <label for="pdfInput">Choose a PDF file:</label>
  <input type="file" id="pdfInput" accept=".pdf" required>
  <br>

  <button type="button" onclick="extractTextFromPDF()">Extract Text</button>
</form>

<!-- Script for extracting text from PDF -->
<script>
  function extractTextFromPDF() {
    const pdfInput = document.getElementById('pdfInput');
    const file = pdfInput.files[0];

    if (file) {
      const reader = new FileReader();

      reader.onloadend = function () {
        if (reader.error) {
          console.error('Error reading file:', reader.error);
          alert('Error reading file. Check the console for details.');
          return;
        }

        // Convert array buffer to typed array
        const typedArray = new Uint8Array(reader.result);

        // Load the PDF file using pdf.js
        pdfjsLib.getDocument(typedArray).then(function (pdf) {
          // Loop through each page
          const numPages = pdf.numPages;
          const pdfTextObject = {};

          for (let pageNum = 1; pageNum <= numPages; pageNum++) {
            // Extract text content from each page
            pdf.getPage(pageNum).then(function (page) {
              page.getTextContent().then(function (textContent) {
                const pageText = textContent.items.map(item => item.str).join(' ');
                pdfTextObject[`Page${pageNum}`] = pageText;

                if (pageNum === numPages) {
                  // Display or further process the extracted text object
                  console.log('PDF Text Object:', pdfTextObject);
                  alert('Text extraction completed. Check the console for details.');
                }
              });
            });
          }
        });
      };

      reader.readAsArrayBuffer(file);
    } else {
      console.error('No file selected.');
      alert('Please choose a PDF file.');
    }
  }
</script>

</body>
</html>
